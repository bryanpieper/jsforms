/*!
 * Django jsforms jQuery plugin
 * http://www.thepiepers.net/
 *
 * This plugin enables the JSON integration between the Django forms and the frontend.
 * 
 * Usage:
 *  <script type="text/javascript">
 *   $("form").jsform();
 *  </script>
 *
 * Copyright (c) 2011, Bryan Pieper
 * Released under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(d){d.fn.jsform=function(i){var a={method:"POST",async:false,dataType:"json",url:undefined,cache:false,loaderElement:undefined,success:function(){},error:function(){},data:function(b){return b.serialize()},preSubmit:function(){}};return this.each(function(){i&&d.extend(a,i);var b=d(this),j=a.url!==undefined?a.url:b.attr("action");j||typeof console!=="undefined"&&console.log("Form does not have an 'action' attribute");var g={e:a.loaderElement,show:function(){this.e&&d(this.e).show()},hide:function(){this.e&&
d(this.e).fadeOut("fast")}};b.submit(function(){g.show();typeof a.preSubmit!=="undefined"&&a.preSubmit(b);var m=a.data(b);d.ajax({url:j,success:function(c){b.children(".error").removeClass("error").find("ul").remove();b.children("ul.errorlist").remove();if(typeof c.errors!=="undefined"&&c.errors)for(var e in c.errors){for(var k=c.errors,f=document.createElement("ul"),h=0;h<k[e].length;h++){var l=document.createElement("li");l.innerHTML=k[e][h];f.appendChild(l)}if(e=="__all__"){f.className="errorlist";
b.children().first().before(f)}else b.children("."+e).addClass("error").children("label").before(f)}else if(typeof c.redirect&&c.redirect)window.location.href=c.redirect;typeof a.success!=="undefined"&&a.success(c);g.hide()},error:function(c){g.hide();typeof a.error!=="undefined"&&a.error(c)},async:a.async,dataType:a.dataType,data:m,type:a.method,cache:a.cache});return false})})}})(jQuery);